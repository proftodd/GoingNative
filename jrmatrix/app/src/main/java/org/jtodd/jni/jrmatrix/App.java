/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package org.jtodd.jni.jrmatrix;

import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.ArrayList;
import java.util.List;

import org.jtodd.jni.JRashunalMatrix;
import org.jtodd.jni.RMatrixJNI;

public class App {
    public static void main(String[] args) throws Exception {
        RMatrixJNI rmj = new RMatrixJNI();

        int data[][][];
        if (args.length > 0) {
            List<String> lines = Files.readAllLines(Paths.get(args[0]));
            ArrayList<int[][]> fileData = new ArrayList<int[][]>();
            for (int i = 0; i < lines.size(); ++i) {
                String line = lines.get(i);
                String[] elements = line.split("(?<!^)[ ]+");
                int[][] lineData = new int[elements.length][];
                for (int j = 0; j < lineData.length; ++j) {
                    String[] elementParts = elements[j].split("/");
                    int[] fractionParts;
                    if (elementParts.length == 1) {
                        fractionParts = new int[] { Integer.parseInt(elementParts[0].trim()) };
                    } else {
                        fractionParts = new int[] {
                            Integer.parseInt(elementParts[0].trim()),
                            Integer.parseInt(elementParts[1].trim()),
                        };
                    }
                    lineData[j] = fractionParts;
                }
                fileData.add(lineData);
            }
            data = new int[fileData.size()][][];
            for (int i = 0; i < data.length; ++i) {
                data[i] = fileData.get(i);
            }
        } else {
            int demoData[][][] = {
                { { 1    }, { 2 }, { 3, 2 }, },
                { { 4, 3 }, { 5 }, { 6    }, },
            };
            data = demoData;
        }
        JRashunalMatrix u = rmj.factorMatrix(data);
        System.out.println(u);
    }
}
